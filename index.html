<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PDF ko‘rish — GitHub Pages</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <style>
    :root {
      --bg:#0f1115; --fg:#e9eef6; --muted:#9fb3c8; --link:#8fd3ff;
      --bar:#151926; --accent:#2a3550; --badge:#1f2740;
    }
    html,body {height:100%; margin:0; background:var(--bg); color:var(--fg); font:15px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,"Noto Sans",sans-serif;}
    .bar {
      display:flex; align-items:center; gap:.75rem; padding:.6rem .8rem; background:var(--bar); border-bottom:1px solid var(--accent);
      position:sticky; top:0; z-index:10;
    }
    .bar code {background:var(--badge); padding:.15rem .45rem; border-radius:.4rem; color:var(--muted)}
    .bar a {color:var(--link); text-decoration:none}
    .bar .sp {flex:1}
    .wrap {position:fixed; inset:2.6rem 0 0 0;}
    .pdf, .fallback {position:absolute; inset:0}
    .fallback {display:flex; align-items:center; justify-content:center; padding:2rem; text-align:center}
    .fallback a {color:var(--link)}
    .hint {color:var(--muted); margin-top:.35rem; font-size:.92em}
    .btn {appearance:none;border:0;border-radius:.45rem;padding:.35rem .6rem;background:var(--accent);color:var(--fg);cursor:pointer}
    .input {background:#0e1220;border:1px solid var(--accent);color:var(--fg);border-radius:.4rem;padding:.35rem .5rem}
    @media (max-width:640px){ .bar span.hide-sm{display:none} }
  </style>
  <script>
    // ---- Sozlanmalar (xohlasangiz o'zgartiring) ----
    const DEFAULT_FILE = "document.pdf";   // Repo ildizida turgan default PDF nomi
    const DEFAULT_PAGE = 1;                // Default sahifa
    const DEFAULT_ZOOM = "page-width";     // PDF viewer parametri: page-width / 100 / 150, va h.k.
    const DEFAULT_TOOLBAR = 1;             // 1=ko‘rinadi, 0=berkitiladi (hamma brauzerda ham ishlamasligi mumkin)

    // URL parametrlari: ?file=...&page=...&zoom=...&toolbar=...
    const params = new URLSearchParams(location.search);
    const file   = (params.get("file")   || DEFAULT_FILE).trim();
    const page   = parseInt(params.get("page") || DEFAULT_PAGE, 10) || DEFAULT_PAGE;
    const zoom   = (params.get("zoom")   || DEFAULT_ZOOM).trim();
    const toolbar= (params.get("toolbar")!== null ? params.get("toolbar") : DEFAULT_TOOLBAR);

    // PDF src ni yig'ish
    const buildPdfSrc = () => {
      // Ba’zi brauzerlar #page bilan birga qo‘shimcha paramlarni ham qo‘llab-quvvatlaydi
      // Masalan: #page=95&zoom=page-width&toolbar=1
      const hash = `#page=${page}&zoom=${encodeURIComponent(zoom)}&toolbar=${toolbar}`;
      return `${file}${hash}`;
    };

    // iOS/Safari’da <embed> bilan ba’zan muammo bo‘ladi — fallback’ga tayyor turamiz
    const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;

    document.addEventListener("DOMContentLoaded", () => {
      const pdfEl = document.getElementById("pdf");
      const linkEl = document.getElementById("directLink");
      const fileEl = document.getElementById("file");
      const pageEl = document.getElementById("page");
      const goEl = document.getElementById("go");

      // UI ni hozirgi qiymatlar bilan to‘ldirish
      fileEl.value = file;
      pageEl.value = page;

      const src = buildPdfSrc();
      pdfEl.src = src;
      linkEl.href = src;

      // Agar iOS bo‘lsa, darhol yangi tabda ochishni taklif qilamiz
      if (isIOS) {
        // iOS ko‘pincha <embed>ni bloklaydi — fallback linkka yo‘naltirish maqsadga muvofiq
        // window.open(src, "_blank");
      }

      // “O‘tish” tugmasi
      goEl.addEventListener("click", () => {
        const nf = fileEl.value.trim() || DEFAULT_FILE;
        const np = parseInt(pageEl.value || DEFAULT_PAGE, 10) || DEFAULT_PAGE;
        const next = `${location.origin}${location.pathname}?file=${encodeURIComponent(nf)}&page=${np}&zoom=${encodeURIComponent(zoom)}&toolbar=${toolbar}`;
        location.assign(next);
      });
    });
  </script>
</head>
<body>
  <div class="bar">
    <span><strong>PDF ko‘rish</strong> <span class="hide-sm">— GitHub Pages</span></span>
    <span class="sp"></span>
    <span><code>?file=...&page=...</code></span>
    <label class="hide-sm">Fayl: <input id="file" class="input" placeholder="document.pdf" style="width:15rem"></label>
    <label>Sahifa: <input id="page" type="number" class="input" min="1" style="width:6rem"></label>
    <button id="go" class="btn">O‘tish</button>
  </div>

  <div class="wrap">
    <!-- Asosiy: PDFni sahifa ichida ochish -->
    <embed id="pdf" class="pdf" type="application/pdf" src="" />

    <!-- Fallback: agar embed ko‘rsatolmasa -->
    <div class="fallback" aria-hidden="true">
      <div>
        <div style="margin-bottom:.5rem">PDF brauzer oynasida ko‘rsatilmayapti.</div>
        <div><a id="directLink" href="#" target="_blank" rel="noopener">PDF’ni bevosita ochish (ko‘pincha ishlaydi)</a></div>
        <div class="hint">Maslahat: Agar brauzer har safar yuklab olsa, <em>Chrome → Settings → Site settings → PDF documents</em> bo‘limida
          “Download PDFs…” opsiyasini <strong>o‘chirib qo‘ying</strong>.</div>
      </div>
    </div>
  </div>

  <noscript>
    <div class="fallback" style="position:static; padding:2rem">
      <p>JavaScript yoqilmagan. PDF uchun quyidagi havoladan foydalaning:</p>
      <p><a href="document.pdf#page=1">document.pdf</a></p>
    </div>
  </noscript>
</body>
</html>
